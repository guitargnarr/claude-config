# Matthew's Parallel Development tmux Config
# Optimized for Claude Code + worktrees workflow

# ====================
# Core Settings
# ====================

# Use Ctrl+a instead of Ctrl+b (easier to reach)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Enable mouse support (scroll, click panes, resize)
set -g mouse on

# Start windows/panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one closes
set -g renumber-windows on

# Increase history limit
set -g history-limit 50000

# Faster key repetition
set -s escape-time 0

# 256 color support
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# ====================
# Pane Management
# ====================

# Split panes with | and -
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Navigate panes with Alt+arrow (no prefix needed)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Resize panes with Ctrl+Alt+arrow
bind -n C-M-Left resize-pane -L 5
bind -n C-M-Right resize-pane -R 5
bind -n C-M-Up resize-pane -U 5
bind -n C-M-Down resize-pane -D 5

# Quick pane cycling with Ctrl+a + o
bind o select-pane -t :.+

# ====================
# Window Management
# ====================

# New window in current path
bind c new-window -c "#{pane_current_path}"

# Quick window switching with Alt+number
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4

# ====================
# Status Bar (Teal/Orange brand)
# ====================

set -g status-position bottom
set -g status-style 'bg=#0f172a fg=#cbd5e1'
set -g status-left '#[bg=#14b8a6,fg=#0f172a,bold] #S #[bg=#0f172a] '
set -g status-left-length 30
set -g status-right '#[fg=#f97316]%H:%M #[fg=#14b8a6]%Y-%m-%d '
set -g status-right-length 50

# Window status
setw -g window-status-current-style 'bg=#14b8a6 fg=#0f172a bold'
setw -g window-status-current-format ' #I:#W '
setw -g window-status-style 'bg=#1e293b fg=#cbd5e1'
setw -g window-status-format ' #I:#W '

# Pane borders
set -g pane-border-style 'fg=#334155'
set -g pane-active-border-style 'fg=#14b8a6'

# ====================
# Parallel Development Layouts
# ====================

# Ctrl+a + p: 4-pane parallel dev layout
bind p \
  split-window -h -c "#{pane_current_path}" \; \
  split-window -v -c "#{pane_current_path}" \; \
  select-pane -t 1 \; \
  split-window -v -c "#{pane_current_path}" \; \
  select-pane -t 1

# Ctrl+a + P: Create parallel session with 4 worktree panes
bind P \
  new-window -n 'parallel' \; \
  split-window -h \; \
  split-window -v \; \
  select-pane -t 1 \; \
  split-window -v \; \
  select-pane -t 1

# Ctrl+a + m: Monitoring layout (main + 3 small)
bind m \
  split-window -h -p 30 -c "#{pane_current_path}" \; \
  split-window -v -c "#{pane_current_path}" \; \
  split-window -v -c "#{pane_current_path}" \; \
  select-pane -t 1

# ====================
# Quick Project Sessions
# ====================

# Ctrl+a + g: Guitar project
bind g new-session -A -s guitar -c ~/Projects/guitar-model-lab

# Ctrl+a + j: Jobs/ai-talent-optimizer
bind j new-session -A -s jobs -c ~/Projects/ai-talent-optimizer

# Ctrl+a + l: Lavos monorepo
bind l new-session -A -s lavos -c ~/Projects/projectlavos-monorepo

# ====================
# Utility Bindings
# ====================

# Reload config
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Quick kill pane (no confirmation)
bind x kill-pane

# Zoom pane toggle
bind z resize-pane -Z

# Synchronize panes (type in all panes at once)
bind S setw synchronize-panes

# ====================
# Copy Mode (vim-style)
# ====================

setw -g mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi Escape send -X cancel

# ====================
# Session Management
# ====================

# Switch sessions with fzf-like menu
bind s choose-tree -Zs

# Kill session
bind X confirm-before -p "Kill session #S? (y/n)" kill-session
